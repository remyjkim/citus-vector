apiVersion: v1
kind: ConfigMap
metadata:
  name: postgres-operator
  namespace: postgres-operator
data:
  # General configuration
  cluster_name_label: cluster-name
  pod_role_label: spilo-role

  # Docker image to use for Spilo pods
  # Override this with your custom image in the cluster manifests
  docker_image: ghcr.io/zalando/spilo-17:4.0-p3

  # Enable features
  enable_crd_registration: "true"
  enable_lazy_spilo_upgrade: "false"
  enable_shm_volume: "true"
  enable_spilo_wal_path_compat: "false"
  enable_team_superuser: "false"
  enable_teams_api: "false"

  # Resource configuration
  # These are defaults that can be overridden in cluster manifests
  min_cpu_limit: "250m"
  min_memory_limit: "250Mi"

  # Connection pooler (PgBouncer) - optional
  connection_pooler_image: "registry.opensource.zalan.do/acid/pgbouncer:master-32"
  connection_pooler_max_db_connections: "60"
  connection_pooler_mode: "transaction"

  # Patroni configuration
  patroni_api_check_interval: "1s"
  patroni_api_check_timeout: "5s"
  patroni_cluster_bootstrap_timeout: "10m"

  # Pod configuration
  pod_management_policy: "ordered_ready"
  pod_terminate_grace_period: "5m"

  # Storage configuration
  storage_resize_mode: "pvc"

  # WAL archiving (optional - configure for production)
  # wal_s3_bucket: "my-backup-bucket"
  # aws_region: "us-east-1"

  # Kubernetes configuration
  watched_namespace: "*"  # Watch all namespaces

  # Logging
  log_level: "info"
  workers: "8"
